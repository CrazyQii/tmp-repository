<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.felix.forum.dao.CommentRepository">

	<select id="get" resultType="com.felix.forum.po.Comment">
		select id,avatar,content,create_time createTime,email,nickname,parent_comment_id parentCommentId,admin_comment adminComment  from t_comment  where id = #{id}
	</select>

	<select id="findByArticleIdAndParentCommentNull" resultType="com.felix.forum.po.Comment" parameterType="com.felix.forum.po.Comment">
		select * from t_comment  where article_id = #{articleId}
	</select>

	<insert id="save" parameterType="com.felix.forum.po.Comment" useGeneratedKeys="true" keyProperty="id">
		insert into t_comment
		(
			avatar,content,create_time,email,nickname,article_id,admin_comment,parent_comment_id
		)
		values
			(
				#{avatar},#{content},#{createTime},#{email},#{nickname},#{articleId},#{adminComment},#{parentCommentId}
			)
	</insert>

	<delete id="delete">
		delete from t_comment where id=#{commentId}
	</delete>
	<select id="queryById" parameterType="int" resultType="int">
		select article_id from t_comment where id=#{commentId}
	</select>

	<select id="queryByParentId" parameterType="int" resultType="int">
		select * from t_comment where parent_comment_id=#{parentCommentId}
	</select>

	<select id="count" parameterType="int" resultType="int">
		select count(*) from t_comment where parent_comment_id=#{parentCommentId}
	</select>

</mapper>